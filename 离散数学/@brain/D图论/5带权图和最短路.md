# 5带权图和最短路

# 基础定义

* 带权图：图$\langle V,E,W\rangle$，$W:E\to \mathbb {Z^+} or \mathbb {R^+}$（本课程采用狭义的权值，即只有正权值，不考虑负权值）
* 通路的权：通路上各边的权之和
* 单源最短路：给定带权图$G$和源点$v_0$，求$v_0$到所有其他点的**权值最小的路径**。

# Dijkstra算法

## 流程

* 初始化集合$S=\{s\}$（$s$为源，$S%$为已经求得最短路的点集），$L(s)=0$（$L(v)$表示从源到$v$的最短路权值）
* 每轮操作（**松弛**）：**设上次最后加入**​**$S$**​**的点为**​**$v_i$**，则对于$\forall v \in V-S \ s.t. \ v_i-v$，若$L(v_i)+W(v_i,v)<L(v)$，则令$L(v)=L(v_i)+W(v_i,v)$，并且记$p(v)=v_i$。（$p(v)$表示$v$的上一节点，即$p(v)$在从$s$到$v$的最短路上；初始时设$p(v)=NULL$）

  本轮以上操作结束后，**取当前**​$V-S$​**中**​**$L(v)$**​**最小的点**​**$v$**​**加入**​**$S$**中。
* 执行$|V|-1$轮之后所有点的最短路都被求出。

大致原理：

* 理论上算法每轮的工作是：对于当前$V-S$中的每个点$v$，用与它相邻的$S$中的所有点$v_i$来执行松弛操作。

  但实际上这样做是冗余的，因为**在第**​$k$轮阶数时**$S$**​**中只会新增1个点**​$v_k$，只会影响到$V-S$中与$v_k$相邻的点（$V-S$中所有点在先前都已经用$S-\{v_k\}$中的所有点松驰过了），因此下一轮只需要用$v_k$来松弛$V-S$中那些与$v_k$相邻的点即可。
* 算法的思想：贪心思想——最短子路径思想

  如果$s-v_1-v_2-...-v_k$是$s$到$v_k$的最短路，那它也必然包含$s$到$v_1,v_2,...,v_{k-1}$的最短路，即步步取优（否则显然可以用反证法说明它不是$s$到$v_k$的最短路）。
* 时间复杂度：$O(|V|^2+|E|)=O(|V|^2)$（每轮的松弛操作加起来正好遍历边集$E$一次；每次松弛完后需要遍历一次$V-S$取出$L(v)$最小的$v$，外层循环要执行$|V|-1$次故找最小的操作时间复杂度为$O(|V|^2)$，又因为简单图$|E|$的规模最大为$O(|V|^2)$，可以合并）

## 正确性证明

Dijkstra算法的正确性依赖于**边权非负，若存在负边权则不能保证求得最短路**。

* 证明：只需**归纳说明**​==算法每轮新加入==​==$S$==​==。==
